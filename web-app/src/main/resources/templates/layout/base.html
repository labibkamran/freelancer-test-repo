<!DOCTYPE html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      class="wa-cloak wa-theme-matter">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title != null ? title + ' - Reai' : 'Reai'}">Reai</title>
    <th:block th:replace="~{layout/libs :: common-libs}"></th:block>
    <link rel="stylesheet" th:href="@{/assets/base/base.css}">

    <!-- Custom head content -->
    <th:block layout:fragment="head"></th:block>
</head>
<body>
<!-- Authenticated User Layout -->
<wa-page mobile-breakpoint="920" th:if="${user != null}">
    <!-- Header -->
    <header slot="header" class="wa-split">
        <div class="wa-cluster">
            <span class="wa-heading-s wa-desktop-only">Reai - Accounting System</span>
            <!-- Company Selector -->
            <wa-dropdown>
                <wa-button slot="trigger" size="small" variant="brand" appearance="outlined" with-caret
                           th:text="${currentCompany != null ? currentCompany.name : 'Select Company'}">
                    Select Company
                </wa-button>
                <wa-dropdown-item th:each="company : ${companies}"
                                  th:onclick="'switchCompany(' + ${company.tenantId} + ')'"
                                  th:class="${currentCompany != null and currentCompany.tenantId == company.tenantId} ? 'selected' : ''">
                    <span th:text="${company.name}">Company Name</span>
                </wa-dropdown-item>
                <wa-divider></wa-divider>
                <wa-dropdown-item onclick="window.open('/company/create', '_blank')">
                    <wa-icon slot="icon" name="plus"></wa-icon>
                    <span>Create New Company</span>
                </wa-dropdown-item>
            </wa-dropdown>
        </div>
        <div class="wa-cluster wa-gap-xs">
            <!-- User Menu -->
            <wa-dropdown>
                <wa-button slot="trigger" size="small" variant="brand" with-caret>
                    <wa-icon slot="prefix" name="user"></wa-icon>
                    <th:block th:text="${user.username}"></th:block>
                </wa-button>
                <wa-dropdown-item onclick="window.location.href='/auth/logout'" variant="danger">
                    <wa-icon slot="icon" name="arrow-right-from-bracket"></wa-icon>
                    Logout
                </wa-dropdown-item>
            </wa-dropdown>
        </div>
    </header>

    <!-- Subheader with breadcrumbs -->
    <nav slot="subheader">
        <div class="wa-cluster" style="flex-wrap: nowrap">
            <wa-button data-toggle-nav appearance="plain" size="small">
                <wa-icon name="bars" label="Menu"></wa-icon>
            </wa-button>
            <wa-breadcrumb style="font-size: var(--wa-font-size-s)">
                <wa-breadcrumb-item
                        th:href="'/dashboard?tenantId=' + ${user.ctx.currentTenant.id}"
                        th:if="${currentCompany != null}" th:text="${currentCompany.name}">
                    Company
                </wa-breadcrumb-item>
                <!-- Breadcrumb Items from child pages -->
                <th:block layout:fragment="breadcrumb-items">
                    <!-- Page breadcrumb content will be inserted here -->
                </th:block>
            </wa-breadcrumb>
        </div>
    </nav>

    <!-- Navigation -->
    <nav slot="navigation">
        <th:block th:if="${user.ctx.currentTenant != null}">
            <!-- Dashboard -->
            <wa-details appearance="outlined" variant="brand">
                <div slot="summary" style="display: flex; align-items: center; gap: 0.5rem;">
                    <wa-icon name="dashboard" aria-hidden="true"></wa-icon>
                    Dashboard
                </div>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li class="wa-body-s">
                        <a th:href="'/dashboard?tenantId=' + ${user.ctx.currentTenant.id}"
                           style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;">
                            Home
                        </a>
                    </li>
                </ul>
            </wa-details>

            <!-- Vouchers Section -->
            <wa-details appearance="outlined" variant="success">
                <div slot="summary" style="display: flex; align-items: center; gap: 0.5rem;">
                    <wa-icon name="file-text" aria-hidden="true"></wa-icon>
                    Vouchers
                </div>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li class="wa-body-s">
                        <a th:href="'/voucher/overview?tenantId=' + ${user.ctx.currentTenant.id}"
                           style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;">
                            Overview
                        </a>
                    </li>
                    <li class="wa-body-s">
                        <a th:href="'/voucher/new-advanced-voucher?tenantId=' + ${user.ctx.currentTenant.id}"
                           style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;">
                            Advanced Voucher
                        </a>
                    </li>
                </ul>
            </wa-details>

            <!-- Account Section -->
            <wa-details appearance="outlined" variant="info">
                <div slot="summary" style="display: flex; align-items: center; gap: 0.5rem;">
                    <wa-icon name="receipt" aria-hidden="true"></wa-icon>
                    Accounts
                </div>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li class="wa-body-s">
                        <a th:href="'/ledger/general?tenantId=' + ${user.ctx.currentTenant.id}"
                           style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;">
                            General Ledger
                        </a>
                    </li>
                </ul>
            </wa-details>

            <!-- Reports Section -->
            <wa-details appearance="outlined" variant="info">
                <div slot="summary" style="display: flex; align-items: center; gap: 0.5rem;">
                    <wa-icon name="chart-simple" aria-hidden="true"></wa-icon>
                    Reports
                </div>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li class="wa-body-s">
                        <a th:href="'/report/trial-balance?tenantId=' + ${user.ctx.currentTenant.id}"
                           style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;">
                            Trial Balance
                        </a>
                    </li>
                </ul>
            </wa-details>
        </th:block>
    </nav>

    <!-- Navigation Footer -->
    <!-- <nav slot="navigation-footer">
         <a href="/company/create" class="wa-flank">
             <wa-icon name="building"></wa-icon>
             <span>Create Company</span>
         </a>
     </nav>-->

    <!-- Aside Sidebar -->
    <aside slot="aside" class="wa-desktop-only" th:if="${user != null}" id="aside-panel">
        <div layout:fragment="aside" id="aside-content">
            <!-- Aside content will be inserted here -->
        </div>
    </aside>

    <!-- Callout -->
    <div th:if="${callout}" style="padding: var(--wa-space-m) var(--wa-space-l) 0;">
        <wa-callout th:attr="variant=${callout.variant()}, data-link=${callout.link}" open
                    th:classappend="${callout.link != null} ? 'clickable-callout' : ''"
                    th:style="${callout.link != null} ? 'cursor: pointer;' : ''">
            <wa-icon slot="icon" th:attr="name=${callout.icon()}" variant="regular"></wa-icon>
            <span th:text="${callout.message}">Message</span>
            <wa-icon th:if="${callout.link != null}" slot="action" name="arrow-up-right-from-square"
                     variant="regular"></wa-icon>
        </wa-callout>
    </div>

    <!-- Main Content -->
    <main layout:fragment="content" id="main-content">
        <!-- Page content will be inserted here -->
    </main>
</wa-page>

<!-- Custom JS -->
<script th:src="@{/assets/base/base.js}"></script>

<!-- Custom scripts -->
<th:block layout:fragment="scripts"></th:block>
</body>
</html>